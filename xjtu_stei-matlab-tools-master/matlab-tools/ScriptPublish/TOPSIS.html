<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
    <title>&#22522;&#20110; TOPSIS &#26041;&#27861;&#30340;&#21307;&#30103;&#36136;&#37327;&#35780;&#20272;</title>
    <meta name="generator" content="MATLAB 9.8">
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
    <meta name="DC.date" content="2021-02-04">
    <meta name="DC.source" content="TOPSIS.m">
    <style type="text/css">
    html,
    body,
    div,
    span,
    applet,
    object,
    iframe,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    p,
    blockquote,
    pre,
    a,
    abbr,
    acronym,
    address,
    big,
    cite,
    code,
    del,
    dfn,
    em,
    font,
    img,
    ins,
    kbd,
    q,
    s,
    samp,
    small,
    strike,
    strong,
    sub,
    sup,
    tt,
    var,
    b,
    u,
    i,
    center,
    dl,
    dt,
    dd,
    ol,
    ul,
    li,
    fieldset,
    form,
    label,
    legend,
    table,
    caption,
    tbody,
    tfoot,
    thead,
    tr,
    th,
    td {
        margin: 0;
        padding: 0;
        border: 0;
        outline: 0;
        font-size: 100%;
        vertical-align: baseline;
        background: transparent
    }

    body {
        line-height: 1
    }

    ol,
    ul {
        list-style: none
    }

    blockquote,
    q {
        quotes: none
    }

    blockquote:before,
    blockquote:after,
    q:before,
    q:after {
        content: '';
        content: none
    }

    :focus {
        outine: 0
    }

    ins {
        text-decoration: none
    }

    del {
        text-decoration: line-through
    }

    table {
        border-collapse: collapse;
        border-spacing: 0
    }

    html {
        min-height: 100%;
        margin-bottom: 1px;
    }

    html body {
        height: 100%;
        margin: 0px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 10px;
        color: #000;
        line-height: 140%;
        background: #fff none;
        overflow-y: scroll;
    }

    html body td {
        vertical-align: top;
        text-align: left;
    }

    h1 {
        padding: 0px;
        margin: 0px 0px 25px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 1.5em;
        color: #d55000;
        line-height: 100%;
        font-weight: normal;
    }

    h2 {
        padding: 0px;
        margin: 0px 0px 8px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 1.2em;
        color: #000;
        font-weight: bold;
        line-height: 140%;
        border-bottom: 1px solid #d6d4d4;
        display: block;
    }

    h3 {
        padding: 0px;
        margin: 0px 0px 5px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 1.1em;
        color: #000;
        font-weight: bold;
        line-height: 140%;
    }

    a {
        color: #005fce;
        text-decoration: none;
    }

    a:hover {
        color: #005fce;
        text-decoration: underline;
    }

    a:visited {
        color: #004aa0;
        text-decoration: none;
    }

    p {
        padding: 0px;
        margin: 0px 0px 20px;
    }

    img {
        padding: 0px;
        margin: 0px 0px 20px;
        border: none;
    }

    p img,
    pre img,
    tt img,
    li img,
    h1 img,
    h2 img {
        margin-bottom: 0px;
    }

    ul {
        padding: 0px;
        margin: 0px 0px 20px 23px;
        list-style: square;
    }

    ul li {
        padding: 0px;
        margin: 0px 0px 7px 0px;
    }

    ul li ul {
        padding: 5px 0px 0px;
        margin: 0px 0px 7px 23px;
    }

    ul li ol li {
        list-style: decimal;
    }

    ol {
        padding: 0px;
        margin: 0px 0px 20px 0px;
        list-style: decimal;
    }

    ol li {
        padding: 0px;
        margin: 0px 0px 7px 23px;
        list-style-type: decimal;
    }

    ol li ol {
        padding: 5px 0px 0px;
        margin: 0px 0px 7px 0px;
    }

    ol li ol li {
        list-style-type: lower-alpha;
    }

    ol li ul {
        padding-top: 7px;
    }

    ol li ul li {
        list-style: square;
    }

    .content {
        font-size: 1.2em;
        line-height: 140%;
        padding: 20px;
    }

    pre,
    code {
        font-size: 12px;
        font-family: Consolas;
    }

    tt {
        font-size: 1.2em;
    }

    pre {
        margin: 0px 0px 20px;
    }

    pre.codeinput {
        padding: 10px;
        border: 1px solid #d3d3d3;
        background: #f7f7f7;
    }

    pre.codeoutput {
        padding: 10px 11px;
        margin: 0px 0px 20px;
        color: #4c4c4c;
    }

    pre.error {
        color: red;
    }

    @media print {

        pre.codeinput,
        pre.codeoutput {
            word-wrap: break-word;
            width: 100%;
        }
    }

    span.keyword {
        color: #0000FF
    }

    span.comment {
        color: #228B22
    }

    span.string {
        color: #A020F0
    }

    span.untermstring {
        color: #B20000
    }

    span.syscmd {
        color: #B28C00
    }

    span.typesection {
        color: #A0522D
    }

    .footer {
        width: auto;
        padding: 10px 0px;
        margin: 25px 0px 0px;
        border-top: 1px dotted #878787;
        font-size: 0.8em;
        line-height: 140%;
        font-style: italic;
        color: #878787;
        text-align: left;
        float: none;
    }

    .footer p {
        margin: 0px;
    }

    .footer a {
        color: #878787;
    }

    .footer a:hover {
        color: #878787;
        text-decoration: underline;
    }

    .footer a:visited {
        color: #878787;
    }

    table th {
        padding: 7px 5px;
        text-align: left;
        vertical-align: middle;
        border: 1px solid #d6d4d4;
        font-weight: bold;
    }

    table td {
        padding: 7px 5px;
        text-align: left;
        vertical-align: top;
        border: 1px solid #d6d4d4;
    }
    </style>
</head>

<body>
    <div class="content">
        <h1>&#22522;&#20110; TOPSIS &#26041;&#27861;&#30340;&#21307;&#30103;&#36136;&#37327;&#35780;&#20272;</h1>
        <!--introduction-->
        <pre>by adqeor@XJTU
&#23567;&#23398;&#26399;&#23646;&#24615;&#24314;&#27169;&#35838;&#31243;&#30340;&#19968;&#20010;&#39064;&#30446;, &#31245;&#21152;&#26356;&#25913;&#21363;&#21487;&#36866;&#29992;&#20110;&#20854;&#20182;&#35780;&#20272;&#20219;&#21153;.</pre>
        <pre>TOPSIS &#35780;&#20272;&#30340;&#19968;&#33324;&#27969;&#31243;:
1. &#25968;&#25454;&#26631;&#20934;&#21270;/&#35268;&#33539;&#21270;, &#38480;&#21046;&#21508;&#25351;&#26631;&#25968;&#25454;&#30340;&#21160;&#24577;&#33539;&#22260;;
2. &#25968;&#25454;&#21516;&#21521;&#21270;, &#21363;&#20351;&#21508;&#20010;&#25351;&#26631;&#30340;&#26368;&#20248;&#21270;&#26041;&#21521;&#30456;&#21516;, &#22343;&#20026;&#26497;&#22823;&#25110;&#26497;&#23567;;
3. &#25968;&#25454;&#21152;&#26435;, &#23545;&#21508;&#20010;&#25351;&#26631;&#36171;&#20104;&#26435;&#37325;;
4. &#35745;&#31639;&#36317;&#31163;, &#35760;&#21508;&#20010;&#25351;&#26631;&#30340;&#26368;&#20540;&#20998;&#21035;&#26500;&#25104; V+, V-, &#27599;&#20010; entity &#21040;&#23427;&#20204;&#30340;&#36317;&#31163;&#20998;&#21035;&#20026; D+, D-.
5. &#21017;&#35813; entity &#30340;&#26368;&#32456;&#35780;&#20998;&#20026; D- / (D+ + D-) = 1 / (1 + D+/D-)</pre>
        <pre>History:
[rev0.1.1] 4 Feb. 2021:
&#25913;&#21464;&#25991;&#26723;&#32467;&#26500;: &#20351;&#29992;&#20998;&#33410;&#20197;&#33719;&#24471;&#26684;&#24335;&#21270;&#30340;&#21457;&#24067;;
&#25913;&#21464;&#35780;&#20272;&#27969;&#31243;: &#23558;&#26631;&#20934;&#21270;&#25552;&#21069;&#20110;&#21516;&#21521;&#21270;;
&#25913;&#21464;&#21516;&#21521;&#21270;&#26041;&#27861;: &#31227;&#38500;&#35266;&#23519;&#21160;&#24577;&#33539;&#22260;, &#36827;&#34892;&#24418;&#22914; y = 10 - x &#30340;&#21464;&#25442;, &#25913;&#20026;&#31616;&#21333;&#27491;&#36127;&#21464;&#21495;;
&#35299;&#20915;&#31639;&#27861;&#38169;&#35823;: &#35745;&#31639;&#26368;&#32456;&#24471;&#20998;&#30340;&#26497;&#24615;&#38169;&#35823;;
&#35843;&#25972;&#20195;&#30721;: &#27880;&#37322;. &#32553;&#36827;, &#21464;&#37327;&#21629;&#21517;, &#21521;&#37327;&#21270;&#35745;&#31639;;
&#22686;&#21152;&#26631;&#20934;&#21270;&#21518;&#25968;&#25454;&#30340;&#28689;&#24067;&#22270;, &#20415;&#20110;&#27604;&#36739;;
&#31227;&#38500;&#21407;&#26377;&#35780;&#20215;&#32472;&#22270;, &#26356;&#25913;&#21629;&#20196;&#34892;&#36755;&#20986;&#32467;&#26524;&#30340;&#26684;&#24335;;
[rev0.1.0] 4 Feb. 2021:
&#24314;&#31435;&#25991;&#26723;, &#26356;&#25913;&#32534;&#30721;&#20026; UTF-8;
11 Jul. 2020:
Last known archive.
7 Jul. 2020:
Create file.</pre>
        <!--/introduction-->
        <h2>Contents</h2>
        <div>
            <ul>
                <li><a href="#1">&#25968;&#25454;&#20934;&#22791;</a></li>
                <li><a href="#3">&#35268;&#33539;&#21270;&#35780;&#20215;&#25351;&#26631;</a></li>
                <li><a href="#4">&#23545;&#24402;&#19968;&#21270;&#30340;&#25968;&#25454;&#21487;&#35270;&#21270;</a></li>
                <li><a href="#5">&#25968;&#25454;&#21516;&#21521;&#21270;</a></li>
                <li><a href="#6">&#35780;&#20215;&#25351;&#26631;&#36171;&#26435;</a></li>
                <li><a href="#7">TOPSIS &#32508;&#21512;&#35780;&#20215;&#21442;&#25968;&#35745;&#31639;</a></li>
            </ul>
        </div>
        <h2 id="1">&#25968;&#25454;&#20934;&#22791;</h2>
        <pre>&#25509;&#19979;&#26469;&#26377;&#21629;&#20196;&#34892;&#31383;&#21475;&#21644;&#32472;&#22270;. &#28165;&#31354;&#20197;&#36991;&#20813;&#24433;&#21709;&#36755;&#20986;.</pre>
        <pre class="codeinput">clc;
close <span class="string">all</span>;
</pre>
        <pre>&#27599;&#34892;&#23384;&#20648;&#19968;&#20010; entity, &#27599;&#20010; entity &#20855;&#26377;&#33509;&#24178;&#21015;&#30340;&#24179;&#22343;&#25351;&#26631;
&#25968;&#25454;&#26684;&#24335;: 0.&#24180;&#20221;: 1994-98, &#22312;&#34920;&#26684;&#20013;&#27809;&#26377;&#20986;&#29616;</pre>
        <pre class="codeinput">stat = [21584 	 76.7 	 7.3 	 1.01 	 78.3 	 97.5 	 2.0
        24372 	 86.3 	 7.4 	 0.80 	 91.1 	 98.0 	 2.0
        22041 	 81.8 	 7.3 	 0.62 	 91.1 	 97.3 	 3.2
        21115 	 84.5 	 6.9 	 0.60 	 90.2 	 97.7 	 2.9
        24633 	 90.3 	 6.9 	 0.25 	 95.5 	 97.9 	 3.6];

[n_Entity, n_Indicator] = size(stat);

entityType = <span class="string">'&#24180;&#20221;'</span>;
entityDescription = cell(1, n_Entity);
<span class="keyword">for</span> i = 1:n_Entity
	entityDescription{i} = num2str(i - 1 + 1994);
<span class="keyword">end</span>

indicatorType = <span class="string">'&#32479;&#35745;&#25351;&#26631;'</span>;
indicatorDescription = {<span class="string">'&#20986;&#38498;&#25968;'</span>, <span class="string">'&#30149;&#24202;&#20351;&#29992;&#29575;'</span>, <span class="string">'&#22343;&#20303;&#38498;&#26085;'</span>, <span class="string">'&#30149;&#27515;&#29575;'</span>,<span class="keyword">...</span>
			<span class="string">'&#25250;&#25937;&#25104;&#21151;&#29575;'</span>, <span class="string">'&#27835;&#24840;&#22909;&#36716;&#29575;'</span>, <span class="string">'&#38498;&#24863;&#29575;'</span>};
</pre>
        <h2 id="3">&#35268;&#33539;&#21270;&#35780;&#20215;&#25351;&#26631;</h2>
        <pre>0-1 &#26631;&#20934;&#21270;, &#26368;&#23567;-&#26368;&#22823;&#35268;&#33539;&#21270;, &#31163;&#24046;&#26631;&#20934;&#21270;
&#23558;[min_data, max_data]&#32447;&#24615;&#26144;&#23556;&#21040;[0, 1]. x' = (x - min)/(max - min)
&#32570;&#28857;: &#23545;&#26497;&#31471;&#20540;/&#31163;&#32676;&#20540;&#25935;&#24863;; &#36801;&#31227;&#24212;&#29992;&#26102;, &#22914;&#26032;&#25968;&#25454;&#26144;&#23556;&#21518;&#19981;&#22312; [0,1], &#36816;&#31639;&#26102;&#21364;&#19981;&#32771;&#34385;&#36229;&#38480;&#24773;&#20917;, &#21487;&#33021;&#24341;&#21457;&#38169;&#35823;.
z-score &#26631;&#20934;&#21270;, &#38646;-&#22343;&#20540;&#35268;&#33539;&#21270;, &#26631;&#20934;&#24046;&#26631;&#20934;&#21270;.
x' = (x - x_bar)/sigma
&#24403;&#21069;&#24212;&#29992;&#26368;&#22810;&#30340;&#26041;&#27861;, &#20294;&#21463;&#31163;&#32676;&#28857;&#24433;&#21709;&#22823;.
&#21487;&#29992;&#20013;&#20301;&#25968;M&#26367;&#20195;&#22343;&#20540;, &#20877;&#29992;&#32477;&#23545;&#26631;&#20934;&#24046; sigma(x_i - W) &#26367;&#20195;&#26631;&#20934;&#24046;. &#20854;&#20013;W&#21487;&#20197;&#26159;&#24179;&#22343;&#25968;, &#20063;&#21487;&#20197;&#26159;&#20013;&#20301;&#25968;.
&#23567;&#25968;&#23450;&#26631;&#26631;&#20934;&#21270;
x' = x/10^k, &#36827;&#32780;&#23558;&#25968;&#20540;&#26144;&#23556;&#21040;[-1, 1]
&#36866;&#29992;&#20110;&#22823;&#21160;&#24577;&#33539;&#22260;&#30340;&#25968;&#25454;</pre>
        <pre class="codeinput">stdMethod = <span class="string">'0-1'</span>;

<span class="keyword">switch</span> stdMethod
	<span class="keyword">case</span> <span class="string">'0-1'</span>
		stat_std = (stat - min(stat)) ./ (max(stat) - min(stat));
	<span class="keyword">case</span> <span class="string">'z-score'</span>
		stat_std = zscore(stat); <span class="comment">% zscore &#40664;&#35748;&#20316;&#29992;&#20110;&#27599;&#19968;&#21015;&#30340;&#25351;&#26631;</span>
	<span class="keyword">otherwise</span>
		warning(<span class="string">'No proper standarize method specified. Use z-score by default.'</span>);
		stat_std = 2 + zscore(stat);
		stdMethod = <span class="string">'z-score'</span>; <span class="comment">% &#23545;&#24322;&#24120;&#20540;&#36827;&#34892;&#25351;&#23450;</span>
<span class="keyword">end</span>
</pre>
        <h2 id="4">&#23545;&#24402;&#19968;&#21270;&#30340;&#25968;&#25454;&#21487;&#35270;&#21270;</h2>
        <pre class="codeinput">colormap(jet);
waterfall(stat_std');
title(<span class="string">'&#24402;&#19968;&#21270;&#25968;&#25454;&#28689;&#24067;&#22270;'</span>);
xlabel(entityType);	xticks(1:n_Entity);	xticklabels(entityDescription);
ylabel(indicatorType);	yticks(1:n_Indicator);	yticklabels(indicatorDescription);
zlabel(sprintf(<span class="string">'%s &#26631;&#20934;&#21270;&#20540;'</span>, stdMethod));
</pre><img vspace="5" hspace="5" src="TOPSIS_01.png" alt="">
        <h2 id="5">&#25968;&#25454;&#21516;&#21521;&#21270;</h2>
        <pre>&#25968;&#25454;&#21516;&#21521;&#21270;: &#36827;&#34892;&#21464;&#25442;, &#20351;&#25152;&#26377;&#25351;&#26631;&#30340;&#26368;&#20248;&#21270;&#26041;&#21521;&#30456;&#21516;
&#20174;&#23454;&#38469;&#38382;&#39064;, &#24076;&#26395;&#31532;1 2 5 6&#21495;&#25351;&#26631;&#26497;&#22823;, 3 4 7&#21495;&#26497;&#23567;
&#19979;&#38754;&#21462;&#26497;&#22823;&#20026;&#21516;&#21521;&#21270;&#26041;&#21521;</pre>
        <pre class="codeinput">stat_uniDir = stat_std;
stat_uniDir(:,3) = -stat_uniDir(:,3);
stat_uniDir(:,4) = -stat_uniDir(:,4);
stat_uniDir(:,7) = -stat_uniDir(:,7);
</pre>
        <h2 id="6">&#35780;&#20215;&#25351;&#26631;&#36171;&#26435;</h2>
        <pre>&#19981;&#21516;&#30340;&#25351;&#26631;(&#22312;&#24402;&#19968;&#21270;&#21518;)&#20855;&#26377;&#19981;&#21516;&#30340;&#26435;&#37325;</pre>
        <pre class="codeinput">weight = ones(1, n_Indicator); <span class="comment">% &#24179;&#20961;&#30340;&#22343;&#19968;&#36171;&#26435;</span>
<span class="comment">%weight = [1 .8 .9 2 5 4 3]; % &#19987;&#23478;&#30340;&#20808;&#39564;&#36171;&#26435;</span>
<span class="comment">%weight = ; % &#29109;&#26435;&#27861;. &#27809;&#26377;&#23458;&#35266;&#23450;&#37327;&#30340;&#25928;&#29992;&#20989;&#25968;, &#36825;&#31181;&#26041;&#27861;&#19981;&#19968;&#23450;&#34892;&#24471;&#36890;.</span>

<span class="comment">% &#26435;&#20540;&#24402;&#19968;&#21270;. &#19981;&#36827;&#34892;&#24402;&#19968;&#21270;&#23545;&#27604;&#36739;&#24179;&#22343;&#27809;&#26377;&#20219;&#20309;&#38382;&#39064;.</span>
weight = weight/sum(weight);
<span class="comment">% &#26435;&#30340;&#24212;&#29992;: &#23545;&#27599;&#19968;&#24180;&#25968;&#25454;&#21521;&#37327;, &#21508;&#20010;&#25351;&#26631;&#20998;&#37327;&#21152;&#26435;. &#24403;&#24180;&#25968;&#25454;&#20173;&#26159;&#19968;&#20010;&#21521;&#37327;.</span>
stat_weighted = weight .* stat_std;
<span class="comment">% &#26631;&#37327;&#25928;&#29992;&#20989;&#25968;: &#23545;&#27599;&#19968;&#24180;&#25968;&#25454;&#21521;&#37327;&#20351;&#29992;&#26435;&#37325;&#20570;&#20869;&#31215;&#20316;&#20026;&#35780;&#20215;. &#24403;&#24180;&#25968;&#25454;&#36864;&#21270;&#20026;&#26631;&#37327;&#25968;&#20540;.</span>
stat_simpleWeighted = stat_std * weight';
</pre>
        <h2 id="7">TOPSIS &#32508;&#21512;&#35780;&#20215;&#21442;&#25968;&#35745;&#31639;</h2>
        <pre>&#21521;&#37327;&#36317;&#31163;, &#27431;&#20960;&#37324;&#24471;&#36317;&#31163;</pre>
        <pre class="codeinput">p = 2;
<span class="comment">% &#22914;&#26524;&#19981;&#38656;&#35201;&#20351;&#29992;&#20013;&#38388;&#21464;&#37327;, &#21487;&#20197;&#19968;&#27493;&#20986;&#32467;&#26524;</span>
<span class="comment">% D_ideal_p2 = vecnorm(stat_weighted - max(stat_weighted), p, 2);</span>
<span class="comment">% D_nadir_p2 = vecnorm(stat_weighted - min(stat_weighted), p, 2);</span>
<span class="comment">% R_p2 = D_nadir_p2 ./ (D_ideal_p2 + D_nadir_p2);</span>
R_p2 = 1 ./ ( 1 +  vecnorm(stat_weighted - max(stat_weighted), p, 2)./vecnorm(stat_weighted - min(stat_weighted), p, 2));

<span class="comment">% &#21521;&#37327;&#36317;&#31163;, &#26364;&#21704;&#39039;&#36317;&#31163;</span>
p = 1;
R_p1 = 1 ./ ( 1 +  vecnorm(stat_weighted - max(stat_weighted), p, 2)./vecnorm(stat_weighted - min(stat_weighted), p, 2));

<span class="comment">% &#21487;&#35270;&#21270;&#30340;&#23454;&#29616;</span>
fprintf(<span class="string">'TOPSIS &#35780;&#21028;&#32467;&#26524;:\n\n&#24180;\t\tTOPSIS\t\t&#31616;&#21333;&#21152;&#26435;\n'</span>);
<span class="keyword">for</span> i = 1:n_Entity
    fprintf(<span class="string">'%d\t%.2f\t\t%.2f\n'</span>, i + 1993, R_p2(i), stat_simpleWeighted(i));
<span class="keyword">end</span>

<span class="comment">% &#26435;&#37325;&#30340;&#35752;&#35770;:</span>
<span class="comment">%</span>
<span class="comment">% "&#20250;&#21741;&#30340;&#23401;&#23376;&#26377;&#22902;&#21507;". &#32473;&#21160;&#24577;&#33539;&#22260;&#22823;&#30340;&#25968;&#25454;, &#36171;&#20104;&#26356;&#22823;&#30340;&#26435;&#37325;.</span>
<span class="comment">% &#29109;&#26435;&#27861;&#27491;&#24335;&#22522;&#20110;&#36825;&#20010;&#24819;&#27861;, &#25104;&#20026;TOPSIS&#36827;&#34892;&#32508;&#21512;&#20998;&#26512;&#20013;, &#25552;&#20379;&#25968;&#25454;&#26435;&#37325;&#19968;&#31181;&#26041;&#27861;.</span>
<span class="comment">%</span>
<span class="comment">% &#36825;&#31181;&#26041;&#27861;&#19981;&#19968;&#23450;&#26159;&#23545;&#30340;.</span>
<span class="comment">%</span>
<span class="comment">% &#31995;&#32479;&#23545;&#26576;&#20123;&#25351;&#26631;&#38750;&#24120;&#25935;&#24863;, &#24494;&#23567;&#30340;&#27874;&#21160;&#23601;&#23558;&#36896;&#25104;&#24040;&#22823;&#30340;&#20307;&#39564;&#20248;&#21270;/&#21155;&#21270;, &#25110;&#26159;&#31995;&#32479;&#24037;&#20316;&#24773;&#20917;&#39588;&#21464;, &#31561;&#31561;.</span>
<span class="comment">% &#32780;&#31995;&#32479;&#23545;&#26576;&#20123;&#21160;&#24577;&#33539;&#22260;&#24456;&#22823;&#30340;&#25351;&#26631;, &#21487;&#33021;&#24182;&#19981;&#25935;&#24863;; &#23427;&#20204;&#21487;&#33021;&#29978;&#33267;&#19981;&#26159;&#31995;&#32479;&#30340;&#20915;&#31574;&#21464;&#37327;.</span>
<span class="comment">%</span>
<span class="comment">% &#20854;&#27425;, &#23545;&#20110;&#32508;&#21512;&#35780;&#20215;&#38382;&#39064;, &#25105;&#20204;&#24182;&#19981;&#30693;&#36947;\frac {\partial result} {\partial variable_i}&#26159;&#35841;&#65307;&#25105;&#20204;&#22522;&#26412;&#19978;&#26159;&#22312;&#30450;&#35780;&#8213;&#8213;&#21482;&#30693;&#36947;&#26576;&#20123;&#25351;&#26631;&#36234;&#22823;/&#23567;/&#38752;&#36817;&#23450;&#20540;, &#36234;&#22909;&#65307;&#36825;&#26159;&#36827;&#34892;&#21028;&#21035;&#30340;&#21807;&#19968;&#26631;&#20934;. &#22914;&#26524;&#23384;&#22312;&#21807;&#19968;&#30340;&#35780;&#20215;&#25351;&#26631;, &#20063;&#23601;&#26159;&#35828;&#8220;&#29992;&#25143;&#8221;&#12289;&#8220;&#30002;&#26041;&#8221;&#35201;&#27714;&#30340;&#23450;&#37327;&#21028;&#21035;&#26631;&#20934;, &#37027;&#20040;&#35797;&#25506;&#24615;&#30340;&#25913;&#21464;&#36755;&#20837;, &#30475;&#36755;&#20986;&#20250;&#22914;&#20309;&#21464;&#21270;, &#36827;&#32780;&#30830;&#31435;&#23545;&#24212;&#21464;&#37327;&#30340;&#26435;&#37325;, &#26159;&#21487;&#34892;&#30340;. &#22914;&#31070;&#32463;&#32593;&#32476;&#35757;&#32451;, &#22914;&#22238;&#24402;&#25311;&#21512;, &#37117;&#26377;&#23450;&#37327;&#30446;&#26631;, &#20351;&#27531;&#24046;&#26368;&#23567;&#31561;&#31561;, &#21487;&#35859;&#8220;&#26377;&#30340;&#25918;&#30690;&#8221;&#65307;&#32780;&#32508;&#21512;&#35780;&#20215;&#38382;&#39064;, &#26368;&#22909;&#30340;&#24773;&#20917;&#26159;&#26377;&#19987;&#23478;&#25552;&#20379;&#20808;&#39564;&#30340;&#26435;&#37325;, &#21487;&#35859;&#26159;&#21482;&#30693;&#23556;&#31243;&#24212;&#24403;&#36828;, &#20934;&#22836;&#35201;&#22909;&#65307;&#20063;&#30693;&#36947;&#26376;&#40657;&#39118;&#39640;&#26102;&#26368;&#23452;&#24367;&#24339;&#23556;&#31661;, &#31455;&#19981;&#30693;&#35201;&#23556;&#21521;&#21738;&#37324;.</span>
</pre>
        <pre class="codeoutput">TOPSIS &#35780;&#21028;&#32467;&#26524;:

&#24180;		TOPSIS		&#31616;&#21333;&#21152;&#26435;
1994	0.39		0.32
1995	0.65		0.73
1996	0.49		0.49
1997	0.43		0.41
1998	0.60		0.69
</pre>
        <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p>
    </div>
    <!--
##### SOURCE BEGIN #####
%% 基于 TOPSIS 方法的医疗质量评估
%  by adqeor@XJTU 
%  小学期属性建模课程的一个题目, 稍加更改即可适用于其他评估任务.
%  
%  TOPSIS 评估的一般流程:
%  1. 数据标准化/规范化, 限制各指标数据的动态范围;
%  2. 数据同向化, 即使各个指标的最优化方向相同, 均为极大或极小;
%  3. 数据加权, 对各个指标赋予权重;
%  4. 计算距离, 记各个指标的最值分别构成 V+, V-, 每个 entity 到它们的距离分别为 D+, D-.
%  5. 则该 entity 的最终评分为 D- / (D+ + D-) = 1 / (1 + D+/D-)
%
%  History:
%  [rev0.1.1] 4 Feb. 2021:
%  改变文档结构: 使用分节以获得格式化的发布;
%  改变评估流程: 将标准化提前于同向化;
%  改变同向化方法: 移除观察动态范围, 进行形如 y = 10 - x 的变换, 改为简单正负变号;
%  解决算法错误: 计算最终得分的极性错误;
%  调整代码: 注释. 缩进, 变量命名, 向量化计算;
%  增加标准化后数据的瀑布图, 便于比较;
%  移除原有评价绘图, 更改命令行输出结果的格式;
%  [rev0.1.0] 4 Feb. 2021:
%  建立文档, 更改编码为 UTF-8;
%  11 Jul. 2020:
%  Last known archive.
%  7 Jul. 2020:
%  Create file.
%

%% 数据准备
%  接下来有命令行窗口和绘图. 清空以避免影响输出.
clc;
close all;

%%
%  每行存储一个 entity, 每个 entity 具有若干列的平均指标
%  数据格式: 0.年份: 1994-98, 在表格中没有出现

stat = [21584 	 76.7 	 7.3 	 1.01 	 78.3 	 97.5 	 2.0
        24372 	 86.3 	 7.4 	 0.80 	 91.1 	 98.0 	 2.0
        22041 	 81.8 	 7.3 	 0.62 	 91.1 	 97.3 	 3.2
        21115 	 84.5 	 6.9 	 0.60 	 90.2 	 97.7 	 2.9
        24633 	 90.3 	 6.9 	 0.25 	 95.5 	 97.9 	 3.6];

[n_Entity, n_Indicator] = size(stat);

entityType = '年份';
entityDescription = cell(1, n_Entity);
for i = 1:n_Entity
	entityDescription{i} = num2str(i - 1 + 1994);
end

indicatorType = '统计指标';
indicatorDescription = {'出院数', '病床使用率', '均住院日', '病死率',...
			'抢救成功率', '治愈好转率', '院感率'};

%% 规范化评价指标
%  0-1 标准化, 最小-最大规范化, 离差标准化
%  将[min_data, max_data]线性映射到[0, 1]. x' = (x - min)/(max - min)
%  缺点: 对极端值/离群值敏感; 迁移应用时, 如新数据映射后不在 [0,1], 运算时却不考虑超限情况, 可能引发错误. 
%  z-score 标准化, 零-均值规范化, 标准差标准化.
%  x' = (x - x_bar)/sigma
%  当前应用最多的方法, 但受离群点影响大.
%  可用中位数M替代均值, 再用绝对标准差 sigma(x_i - W) 替代标准差. 其中W可以是平均数, 也可以是中位数. 
%  小数定标标准化
%  x' = x/10^k, 进而将数值映射到[-1, 1]
%  适用于大动态范围的数据

stdMethod = '0-1';

switch stdMethod
	case '0-1'
		stat_std = (stat - min(stat)) ./ (max(stat) - min(stat));
	case 'z-score'
		stat_std = zscore(stat); % zscore 默认作用于每一列的指标
	otherwise
		warning('No proper standarize method specified. Use z-score by default.');
		stat_std = 2 + zscore(stat);
		stdMethod = 'z-score'; % 对异常值进行指定
end

%% 对归一化的数据可视化

colormap(jet);
waterfall(stat_std');
title('归一化数据瀑布图');
xlabel(entityType);	xticks(1:n_Entity);	xticklabels(entityDescription);
ylabel(indicatorType);	yticks(1:n_Indicator);	yticklabels(indicatorDescription);
zlabel(sprintf('%s 标准化值', stdMethod));

%% 数据同向化
%  数据同向化: 进行变换, 使所有指标的最优化方向相同
%  从实际问题, 希望第1 2 5 6号指标极大, 3 4 7号极小
%  下面取极大为同向化方向
stat_uniDir = stat_std;
stat_uniDir(:,3) = -stat_uniDir(:,3);
stat_uniDir(:,4) = -stat_uniDir(:,4);
stat_uniDir(:,7) = -stat_uniDir(:,7);

%% 评价指标赋权
%  不同的指标(在归一化后)具有不同的权重
weight = ones(1, n_Indicator); % 平凡的均一赋权
%weight = [1 .8 .9 2 5 4 3]; % 专家的先验赋权
%weight = ; % 熵权法. 没有客观定量的效用函数, 这种方法不一定行得通. 

% 权值归一化. 不进行归一化对比较平均没有任何问题.
weight = weight/sum(weight);
% 权的应用: 对每一年数据向量, 各个指标分量加权. 当年数据仍是一个向量.
stat_weighted = weight .* stat_std;
% 标量效用函数: 对每一年数据向量使用权重做内积作为评价. 当年数据退化为标量数值.
stat_simpleWeighted = stat_std * weight';

%% TOPSIS 综合评价参数计算
%  向量距离, 欧几里得距离
p = 2;
% 如果不需要使用中间变量, 可以一步出结果
% D_ideal_p2 = vecnorm(stat_weighted - max(stat_weighted), p, 2);
% D_nadir_p2 = vecnorm(stat_weighted - min(stat_weighted), p, 2);
% R_p2 = D_nadir_p2 ./ (D_ideal_p2 + D_nadir_p2);
R_p2 = 1 ./ ( 1 +  vecnorm(stat_weighted - max(stat_weighted), p, 2)./vecnorm(stat_weighted - min(stat_weighted), p, 2));

% 向量距离, 曼哈顿距离
p = 1;
R_p1 = 1 ./ ( 1 +  vecnorm(stat_weighted - max(stat_weighted), p, 2)./vecnorm(stat_weighted - min(stat_weighted), p, 2));

% 可视化的实现
fprintf('TOPSIS 评判结果:\n\n年\t\tTOPSIS\t\t简单加权\n');
for i = 1:n_Entity
    fprintf('%d\t%.2f\t\t%.2f\n', i + 1993, R_p2(i), stat_simpleWeighted(i));
end

% 权重的讨论: 
% 
% "会哭的孩子有奶吃". 给动态范围大的数据, 赋予更大的权重.
% 熵权法正式基于这个想法, 成为TOPSIS进行综合分析中, 提供数据权重一种方法. 
% 
% 这种方法不一定是对的. 
% 
% 系统对某些指标非常敏感, 微小的波动就将造成巨大的体验优化/劣化, 或是系统工作情况骤变, 等等.
% 而系统对某些动态范围很大的指标, 可能并不敏感; 它们可能甚至不是系统的决策变量. 
% 
% 其次, 对于综合评价问题, 我们并不知道\frac {\partial result} {\partial variable_i}是谁；我们基本上是在盲评――只知道某些指标越大/小/靠近定值, 越好；这是进行判别的唯一标准. 如果存在唯一的评价指标, 也就是说“用户”、“甲方”要求的定量判别标准, 那么试探性的改变输入, 看输出会如何变化, 进而确立对应变量的权重, 是可行的. 如神经网络训练, 如回归拟合, 都有定量目标, 使残差最小等等, 可谓“有的放矢”；而综合评价问题, 最好的情况是有专家提供先验的权重, 可谓是只知射程应当远, 准头要好；也知道月黑风高时最宜弯弓射箭, 竟不知要射向哪里. 


##### SOURCE END #####
-->
</body>

</html>